[
  {
    "objectID": "Links.html",
    "href": "Links.html",
    "title": "Direct links to the website and Netlify site overview:",
    "section": "",
    "text": "Direct links to the website and Netlify site overview:\nWebsite\nNetlify"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About Us:\nGoh Shao Hsuen(Y2S1)\nMartyn Tok(Y2S1)\nSavannah Koh(Y2S1)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "FloodSafe: Derna, Libya",
    "section": "",
    "text": "This website comprises an overview of how we wish to tackle the issue of GIS-Based Accessibility Analysis and Mapping of Emergency and Medical Services.\nWe will be using the recent flooding in Libya as our case study, and map out the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood.\nHere is a quick summary of our project via our townhall presentation poster:"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "GIS Project",
    "section": "",
    "text": "This website comprises an overview of how we wish to tackle the issue of GIS-Based Accessibility Analysis and Mapping of Emergency and Medical Services!\nWe will be using the recent flooding in Libya as our case study, and map out the accessibility for the future."
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "FloodSafe: Derna, Libya",
    "section": "",
    "text": "This website comprises an overview of how we wish to tackle the issue of GIS-Based Accessibility Analysis and Mapping of Emergency and Medical Services.\nWe will be using the recent flooding in Libya as our case study, and map out the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood.\nHere is a quick summary of our project via our townhall presentation poster:"
  },
  {
    "objectID": "overview.html",
    "href": "overview.html",
    "title": "Overview",
    "section": "",
    "text": "On the 10th of September 2023, Storm Daniel hit the City of Derna, Libya. This caused a massive flood due to the destruction of two dams, displacing tens of thousands of people. The flood devastated the city centre and destroyed huge swathes of homes, buildings and other infrastructure in the area. According to UNICEF, the natural disaster also affected health, education and safe water supply services. This created a massive humanitarian crisis for the city, with disaster relief efforts underway by various organisations."
  },
  {
    "objectID": "overview.html#overview",
    "href": "overview.html#overview",
    "title": "Overview",
    "section": "",
    "text": "Our project's objectives are to utilise what we have learnt to conduct a GIS-based accessibility analysis and mapping of emergency evacuation centres and medical services in the case study in Derna, Libya, due to the recent flooding in September 2023.\nThe main motivation was how the increased occurrence and intensity of natural disasters in recent years will require us to invest in new methods to mitigate their adverse effects, as well as develop more effective disaster planning and response frameworks. It is important for us to recognise that at the different phases of a disaster, each will have its own distinct and specific community needs.\nWe found that strategically pre-planning evacuation routes to access emergency centres before and medical services during a flood can play a pivotal role in substantially mitigating casualties. Moreover, identifying pathways to essential supplies in the aftermath of a flood not only fosters the city’s restoration but also optimises resource allocation during critical times of crisis.\nHence, our aim was to determine the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood, namely the before, during and after scenario of the entire flood event.\nOur findings indicated what were the best paths to evacuate in each neighbourhood before the flood would occur, based on prior warnings 6 hours before.\nNext, we found the best evacuation routes to the nearest dry road and shelter, for those who were unable to evacuate in time during the flood itself.\nFinally, as supplies in the shelters were being used up and the supplies back in the flooded neighbourhoods began to perish, we found the most efficient resupply routes back to the neighbourhoods.\nWe hope that these findings would serve as a good indication of network analysis for the various stages of a disaster scenario for Derna, in the event of another crisis."
  },
  {
    "objectID": "overview.html#summary",
    "href": "overview.html#summary",
    "title": "Overview",
    "section": "",
    "text": "Our project’s objectives are to utilise what we have learnt to conduct a GIS-based accessibility analysis and mapping of emergency evacuation centres and medical services in the case study in Derna, Libya, due to the recent flooding in September 2023.\nThe main motivation was how the increased occurrence and intensity of natural disasters in recent years will require us to invest in new methods to mitigate their adverse effects, as well as develop more effective disaster planning and response frameworks. It is important for us to recognise that at the different phases of a disaster, each will have its own distinct and specific community needs.\nWe found that strategically pre-planning evacuation routes to access emergency centres before and medical services during a flood can play a pivotal role in substantially mitigating casualties. Moreover, identifying pathways to essential supplies in the aftermath of a flood not only fosters the city’s restoration but also optimises resource allocation during critical times of crisis.\nHence, our aim was to determine the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood, namely the before, during and after scenario of the entire flood event.\nOur findings indicated what were the best paths to evacuate in each neighbourhood before the flood would occur, based on prior warnings 6 hours before.\nNext, we found the best evacuation routes to the nearest dry road and shelter, for those who were unable to evacuate in time during the flood itself.\nFinally, as supplies in the shelters were being used up and the supplies back in the flooded neighbourhoods began to perish, we found the most efficient resupply routes back to the neighbourhoods.\nWe hope that these findings would serve as a good indication of network analysis for the various stages of a disaster scenario for Derna, in the event of another crisis."
  },
  {
    "objectID": "proposal.html#objective",
    "href": "proposal.html#objective",
    "title": "Proposal",
    "section": "Objective",
    "text": "Objective"
  },
  {
    "objectID": "proposal.html#data",
    "href": "proposal.html#data",
    "title": "Proposal",
    "section": "Data",
    "text": "Data\n\nCopernicus EMSR roads (with degree of damage)\nOSM Roads (1 Sep 23)\nOSM Roads, Landuse, Points of Interest and Places of Worship, transport_a (23 Oct 23)\nFlood Extent from HumData Exchange portal\nDerna City Hexagon (for clipping of datapoints)"
  },
  {
    "objectID": "proposal.html#scope",
    "href": "proposal.html#scope",
    "title": "Proposal",
    "section": "Scope",
    "text": "Scope"
  },
  {
    "objectID": "proposal.html#project-timeline",
    "href": "proposal.html#project-timeline",
    "title": "Proposal",
    "section": "Project Timeline",
    "text": "Project Timeline\nThis is our project Gantt Chart and timeline of the project."
  },
  {
    "objectID": "methodology.html",
    "href": "methodology.html",
    "title": "Methodology",
    "section": "",
    "text": "Summary Flow Chart\n\nWe chose to set our project CRS as EPSG:3197 as it is the CRS with the smallest extent that includes our study area.\n\n\nData Download"
  },
  {
    "objectID": "results.html#future-work",
    "href": "results.html#future-work",
    "title": "Results and Discussion",
    "section": "Future Work",
    "text": "Future Work"
  },
  {
    "objectID": "results.html#recommendations",
    "href": "results.html#recommendations",
    "title": "Results and Discussion",
    "section": "Recommendations",
    "text": "Recommendations"
  },
  {
    "objectID": "lessons.html",
    "href": "lessons.html",
    "title": "Lessons",
    "section": "",
    "text": "Our group realized that data cleaning is an extremely important step in analysis, as it would cause many problems down the line as we start working with the data and realizing it would be too messy.\nFor our approach, we had many trial and error attempts while figuring out what we were going to do. We initially thought of using the Iso-Area function to flag the areas that were closer to or further from the shelters, but realized the range was too small to be of significant concern (e.g. within 1.5km or within a few minutes drive). We also found that starting points that are close to shelters may be misleading as the closest shelter may not have the capacity to contain evacuees from there.\nWith regards to finding existing functions to use for our analysis, we had 2 changes.\n\nWe tried to use batch processing shortest path (point to layer), but later realized OD matrix is more efficient as two of our machines were stuck at the batch process.\nBefore we found the functions ‘Line Intersections’ and ‘Polygons to Lines’, we used the ‘Merge Vector Layer’ and ‘Merging Lines’ and had issues as the resulting output data was very dirty.\n\nThese changes allowed us to better use the different functions in the QGIS software, allowing us to have a more comprehensive understanding of the entire process."
  },
  {
    "objectID": "lessons.html#lessons-learnt",
    "href": "lessons.html#lessons-learnt",
    "title": "Lessons",
    "section": "",
    "text": "Our group realized that data cleaning is an extremely important step in analysis, as it would cause many problems down the line as we start working with the data and realizing it would be too messy.\nFor our approach, we had many trial and error attempts while figuring out what we were going to do. We initially thought of using the Iso-Area function to flag the areas that were closer to or further from the shelters, but realized the range was too small to be of significant concern (e.g. within 1.5km or within a few minutes drive). We also found that starting points that are close to shelters may be misleading as the closest shelter may not have the capacity to contain evacuees from there.\nWith regards to finding existing functions to use for our analysis, we had 2 changes.\n\nWe tried to use batch processing shortest path (point to layer), but later realized OD matrix is more efficient as two of our machines were stuck at the batch process.\nBefore we found the functions ‘Line Intersections’ and ‘Polygons to Lines’, we used the ‘Merge Vector Layer’ and ‘Merging Lines’ and had issues as the resulting output data was very dirty.\n\nThese changes allowed us to better use the different functions in the QGIS software, allowing us to have a more comprehensive understanding of the entire process."
  },
  {
    "objectID": "overview.html#introduction",
    "href": "overview.html#introduction",
    "title": "Overview",
    "section": "",
    "text": "On the 10th of September 2023, Storm Daniel hit the City of Derna, Libya. This caused a massive flood due to the destruction of two dams, displacing tens of thousands of people. The flood devastated the city centre and destroyed huge swathes of homes, buildings and other infrastructure in the area. According to UNICEF, the natural disaster also affected health, education and safe water supply services. This created a massive humanitarian crisis for the city, with disaster relief efforts underway by various organisations."
  },
  {
    "objectID": "overview.html#project-summary",
    "href": "overview.html#project-summary",
    "title": "Overview",
    "section": "Project Summary",
    "text": "Project Summary\nOur project’s objectives are to utilise what we have learnt to conduct a GIS-based accessibility analysis and mapping of emergency evacuation centres and medical services in the case study in Derna, Libya, due to the recent flooding in September 2023.\nThe main motivation was how the increased occurrence and intensity of natural disasters in recent years will require us to invest in new methods to mitigate their adverse effects, as well as develop more effective disaster planning and response frameworks. It is important for us to recognise that at the different phases of a disaster, each will have its own distinct and specific community needs.\nWe found that strategically pre-planning evacuation routes to access emergency centres before and medical services during a flood can play a pivotal role in substantially mitigating casualties. Moreover, identifying pathways to essential supplies in the aftermath of a flood not only fosters the city’s restoration but also optimises resource allocation during critical times of crisis.\nHence, our aim was to determine the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood, namely the before, during and after scenario of the entire flood event.\nOur findings indicated what were the best paths to evacuate in each neighbourhood before the flood would occur, based on prior warnings 6 hours before.\nNext, we found the best evacuation routes to the nearest dry road and shelter, for those who were unable to evacuate in time during the flood itself.\nFinally, as supplies in the shelters were being used up and the supplies back in the flooded neighbourhoods began to perish, we found the most efficient resupply routes back to the neighbourhoods.\nWe hope that these findings would serve as a good indication of network analysis for the various stages of a disaster scenario for Derna, in the event of another crisis."
  },
  {
    "objectID": "proposal.html",
    "href": "proposal.html",
    "title": "Proposal",
    "section": "",
    "text": "With the number of natural disasters increasing in intensity and frequency, it is important to invest in ways to mitigate the adverse effects and develop appropriate disaster planning and response frameworks to better manage similar or more catastrophic occurrences in the future. Thus, our objective is to utilise what we have learned, Geographic Information technologies, to conduct a GIS-based accessibility analysis and mapping of emergency evacuation centres and medical services in this case study in Derna, Libya. \nIn a city ravaged by natural disasters, it is also crucial to recognize that different phases of an event entail distinct and specific community needs. Strategically pre-planning evacuation routes to access emergency centresbefore and medical services during a flood can play a pivotal role in substantially mitigating casualties. Moreover, identifying pathways to essential supplies in the aftermath of a flood not only fosters the city’s restoration but also optimises resource allocation during critical times of crisis.\nTherefore, our project – FloodSafe – aims to determine the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood. We presented our results and analysis in three flood scenarios: Before, During and After."
  },
  {
    "objectID": "proposal.html#objectives-and-motivation",
    "href": "proposal.html#objectives-and-motivation",
    "title": "Proposal",
    "section": "",
    "text": "With the number of natural disasters increasing in intensity and frequency, it is important to invest in ways to mitigate the adverse effects and develop appropriate disaster planning and response frameworks to better manage similar or more catastrophic occurrences in the future. Thus, our objective is to utilise what we have learned, Geographic Information technologies, to conduct a GIS-based accessibility analysis and mapping of emergency evacuation centres and medical services in this case study in Derna, Libya. \nIn a city ravaged by natural disasters, it is also crucial to recognize that different phases of an event entail distinct and specific community needs. Strategically pre-planning evacuation routes to access emergency centresbefore and medical services during a flood can play a pivotal role in substantially mitigating casualties. Moreover, identifying pathways to essential supplies in the aftermath of a flood not only fosters the city’s restoration but also optimises resource allocation during critical times of crisis.\nTherefore, our project – FloodSafe – aims to determine the most efficient paths to get people to safety, medical care, and supplies in different stages of the flood. We presented our results and analysis in three flood scenarios: Before, During and After."
  },
  {
    "objectID": "proposal.html#data-used",
    "href": "proposal.html#data-used",
    "title": "Proposal",
    "section": "Data Used",
    "text": "Data Used\n\nCopernicus EMSR roads (with degree of damage)\nLibya OSM Roads (1 Sep 23)\nLibya OSM Roads, landuse_a, Points of Interest and Places of Worship, transport_a (23 Oct 23)\nFlood Extent from HumData Exchange portal\nHealth Facilities from HumData Exchange portal (Hospitals)\nSatellite data from OpenAerialMap\nDerna City Hexagon (for clipping of datapoints)"
  },
  {
    "objectID": "proposal.html#scope-of-work",
    "href": "proposal.html#scope-of-work",
    "title": "Proposal",
    "section": "Scope of Work",
    "text": "Scope of Work\nPrepare shelters data by classification, hospitals data, residential neighbourhoods in flood extent and OSM roads.\n\nBefore Scenario\n\nUse 1 September 2023 OSM roads, find shelters outside flood extent, and use OD Matrix tool from residential centroids to said shelters.\nUse python pandas to assign up to 10 neighbourhood centroids to each shelter, starting from the furthest one.\n\n\n\nDuring Scenario\n\nFind suitable roads outside flood extent, find start points from intersections with the flood extent that are connected to road networks.\nExtract suitable shelters and hospitals outside the flood extent, use OD Matrix and SQL to form evacuation routes and shortest paths from start points to suitable shelters and hospitals.\n\n\n\nAfter Scenario\n\nFind suitable roads and create airport centroids.\nFind airports and desalination plants as the starting points and residential neighbourhoods, hospitals and shelters(outside flood extent) as end points.\nSelect a midpoint on the previous shortest path on EMSR road and find shortest path to that from our start points using OSM roads.\nFind shortest path to our endpoints from said midpoint to get the routes."
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "Results and Discussion",
    "section": "",
    "text": "From our findings, the routes range from a distance of 2.3km to 4.8km. Assuming a 4-6 km/h walking speed for people, it would take less than half an hour to an hour for people to evacuate by foot.\nBy vehicle, it takes about 4 minutes 5 seconds to 6 minutes 12 seconds to evacuate, using the speed assumptions (50km/h for motor roads, 15km/h for service and unclassified roads, 5km/h for pedestrian roads) and not accounting for delays due to traffic congestion. \nRoughly multiplying the time taken by 10, we get an estimate of around 41-62 minutes for a person to walk. This estimate is slightly higher than that of the previous walking duration estimation, but may be more accurate in accounting for fatigue or congestion, or vulnerable populations like children, elderly and people with disabilities.\n\nThese routes are still reasonable considering the 5-8 hours heads-up the residents received - that they have enough time to get home to find essential emergency items or family members and evacuate.\n\n\n\nAs seen in the map, the python algorithm was successful in assigning neighbourhood centroids to maximise the use of shelters. The neighbourhood centroids closest to the perimeter of the flood extent are assigned to the furthest shelters as expected, allowing them to escape earlier to reduce congestion with the people deeper within in the flood extent.\nAs mentioned, the main downside of having assigned routes is that some routes may experience congestion due to traffic bottlenecks (multiple neighbourhoods of people are passing through the same road). However, this can be mitigated as the locals would have knowledge of the alternative routes in the city in case of congestion.\nAs measured, the combined area of the shelters outside of the flood extent (used in before and during scenarios) is 3 hectares though the total area of the residential buildings is 50 hectares. Though this does not account for the number of storeys each building has, it is a sign that the existing shelters may not be sufficient to hold all evacuees.\nWe divide the current area of shelters (assuming at least 1 storey of free space) 33,251m2 by UNHCR’s standard of 3.5m2 per person, to get an estimate of a capacity of more than 9,500 people, which pales in comparison to the 24,500 displaced residents figure.This could be sufficient if the shelters have almost 3 storeys of usable space (85,750m2), but we currently lack data on building heights. \n\nCross-referencing the UN’s 21st September update, in reality only 6 schools were used as designated sites to hold evacuees. Though we are unsure of UN’s considerations in selecting the holding sites, our maps present a possibility of using mosques and hotels as shelters to accommodate more evacuees and save more lives. In the event that our solution remains insufficient, people could also move out of Derna to nearby cities to escape, as the UNOCHA report had noted. The potential lack of shelter capacity should not stop people from evacuating before the flood.\n\n\n\n\n\n\n\nThe map created shows all possible routes from start points from the edge of the flood extent (black paths) to all safe and undamaged shelters - evacuation centres - outside the flood extent. It also shows the shortest routes (red paths) from each specific start point to their nearest shelters. The route with the shortest distance from a start point to a shelter is 41.60 metres while the route with the longest distance from a start point to a shelter is 5380.93 metres. The great disparity between the shortest route and the longest route shows that some shelters are far more inaccessible than others, such as the one on the extreme bottom right corner of the map. This is evident in the relatively sparse distribution of shelters and the lack of suitable road networks that lead to those that are further away from the start points. \nMost of the shortest paths also lead to the same few shelters. This makes sense since those shelters are closest in proximity to the damaged flood area.\n\n\nUpon further analysis, most of the shortest paths from the start points on the left side of the flood extent lead to three of the nearest shelters (circled in yellow) as shown in Zoom-in Map 1 inserted above. Many shelters further away from the flood extent are not included in the evacuation map’s shortest path to safety. The second map also reveals that some shelters (circled in green), though in close proximity to other surrounding shelters, have no path mapped to them. This could possibly be due to the affected road network which the OD Matrix algorithm could not account for. This means that many shelters will be underutilised if all evacuees choose to go to the nearest shelter. \nMoreover, this evacuation map is generated under the assumption that people will be using walking as the primary means to travel from a start point to a shelter, as it is unlikely that vehicles could be used for transportation during the flood, especially starting from the flood extent. In reality, it is possible that there may be alternative routes, such as desire paths, that are more intuitive and efficient for people to use for evacuation to the first shelter they see. \nAlthough the shortest paths show the general routes that would be most convenient for people to use for evacuation to their nearest shelters, this might lead to overcrowding in those few particular shelters. Therefore, it is recommended that people travel to the next nearest shelter if the ‘Shortest Path’ leads them to a shelter that has already maximised its capacity, using ‘All Routes to Shelters’. \n\n\n\n\nThe map created shows all possible routes from start points from the edge of the flood extent (black paths) to all medical centres - hospitals - outside the flood extent. It also shows the shortest routes (red paths) from each specific start point to their nearest hospital. The route with the shortest distance from a start point to a hospital is 818.28 metres while the route with the longest distance from a start point to a hospital is 4427.44 metres. This shows that some start points are considerably closer in proximity to a hospital than others.\n\nThe map also shows that there are only three hospitals which people can evacuate to for medical care outside the flood extent. As seen from the map inserted below, all routes to the nearest hospital from start points on the left side of the flood extent are also all the shortest paths to the hospital, as there is only one hospital in that vicinity. This suggests potential overcrowding in this hospital, and people who are severely injured during the flood and attempting to evacuate from start points nearer the coastline are likely unable to travel to the hospital on foot unless there are emergency ambulances deployed to help them.\n\n\nThe map above indicates that most of the routes to hospitals from start points on the right side of flood extent go to the hospital nearest to the flood extent. This is due to the skewed distribution of hospital locations as the last hospital is situated far away from the start points. \n\nDue to the scarcity of medical centres, it is possible that these hospitals will be overcrowded and their manpower and supplies exhausted to tend to patients. As such, it is recommended that field hospitals or mobile clinics be deployed to remote areas nearer to the flood extent or to evacuation centres with people who require the most medical care.\n\n\n\nWe learnt from team 8's poster showcase to consider the accessibility to hospitals from the shelters. We consider only vehicle timings as we realise the shortest paths may be too far to walk by foot, especially for someone who is injured. Hence, we assume that the injured are able to call an ambulance from the hospital to fetch them. The time taken to send them to the hospital would be double of the time spent on the route as the ambulance has to go back and forth: leave the hospital to fetch them, then send them to the hospital. \n\nThe most likely sickness that could occur at shelters are likely to be diarrhoea from damaged water supplies, or infections, hence we consider the 11 minutes maximum to be reasonable. There are also likely other people with phones to make timely calls for ambulances, and vehicles of other evacuees that would hasten sending the sick to the hospitals in less than 6 minutes (one-way journey instead of back-and-forth).\n\n\nWe consider the 15 minutes maximum time to dispatch an ambulance and fetch the injured people from the flood extent reasonable, though we note limitations such as the possibility of the injured not having a working phone with them, or having to walk up to 379 metres to the nearest startpoint with their injuries after having escaped the flood.\nAlso, we used a different set of road networks from the shortest path analysis in the during scenario (from startpoints to shelters and hospitals). We used OSM roads as it had information on road types (for speeds) and directions to run out fastest time path analysis, compared to the EMSR roads for shortest distance analysis. As such, there were discrepancies where all 60 start points were accessible by EMSR roads but only 46 for OSM roads network. As such, our fastest path analysis was unable to account for 14 of the startpoints.\n\n\n\n\nFor the logistical and water resupplies, we decided to map the shortest path in order to ensure that any people returning back to their homes will have sufficient resources and supplies. The shelters and hospitals would likely be overcrowded, and people will want to return home as well. In the event of a post-flood, we want to ensure that those residents returning home have sufficient supplies and proper water resources. Hence, we mapped the shortest, most accessible routes for both resupplies using the Shortest Path analysis function. \nWe found that there were some centroid points where there weren’t any networks/paths found to lead to it from the starting point. This is due to the unavailability of roads directly to that specific point, hence for those points we can assume that the resupplies needed for that area can be received from the nearest point to it where the possible routes end instead. Given the numerous centroids, and the many specific paths provided by the analysis, we can still use these networks to resupply even if there is not a specific route directly connected to it.\nFor a lot of the paths, we noticed that a few of the paths would diverge from a similar starting point, before heading towards the centroids.\n\n\nAn example is these 2 corners shown, where there were multiple paths diverging depending on the centroids they are heading towards. For suppliers (in the future to centroids, shelters and hospitals), they could place and store resupplies near these diverging points. The trucks and vehicles would then be able to pick up more supplies from these areas on the way to their destination points. It would decentralise any resupply points and reduce the potential load of the vehicles carrying supplies from these points that are very far away from the city. Hence, potential resupplies can be first dropped off at these points, in larger quantities, before being picked up by other vehicles in the area in order to be sent to the destinations. This would ensure faster resupplies, as vehicles would be able to move faster, more frequently and more efficiently to their destinations. \n\n\n\nWe also assumed that people will attempt to return to their homes in the aftermath of the flood and thereby planned out logistical and water resupply routes to the residential areas that had been affected by the flood. However, we also recognise that many survivors might also choose to remain in the shelters until their homes are restored into their original conditions, and hospitals may require more supplies than usual. Hence, we also mapped the logistical and water resupply to shelters and hospitals. \nThough not presented in our physical poster, we mapped out the supply routes to hospitals and shelters outside the flood extent. These utilise roads that have not been damaged by the  floods, and can be used in the Before Flood and After Flood scenarios. As some routes cross the flood extent, they are not advisable for use in the During Flood scenario.\nWhile the After Flood scenario focused on the likely case of providing aid to people who moved back home after the flood has subsided, these maps look into potential use cases of readying the shelters and hospitals before the flood, and resupplying them in the first few weeks after the flood. Supplies in the Before Flood scenario should be enough to last people for 2-3 days for the duration of the flood, while supplies in the After Flood scenario may come as and when replenishments are required.\n\nThe water and logistics resupply routes during the flood take up to 3 hours, and less than 2 hours in the before and after scenario."
  },
  {
    "objectID": "results.html#analysis",
    "href": "results.html#analysis",
    "title": "Results and Discussion",
    "section": "",
    "text": "From our findings, the routes range from a distance of 2.3km to 4.8km. Assuming a 4-6 km/h walking speed for people, it would take less than half an hour to an hour for people to evacuate by foot.\nBy vehicle, it takes about 4 minutes 5 seconds to 6 minutes 12 seconds to evacuate, using the speed assumptions (50km/h for motor roads, 15km/h for service and unclassified roads, 5km/h for pedestrian roads) and not accounting for delays due to traffic congestion. \nRoughly multiplying the time taken by 10, we get an estimate of around 41-62 minutes for a person to walk. This estimate is slightly higher than that of the previous walking duration estimation, but may be more accurate in accounting for fatigue or congestion, or vulnerable populations like children, elderly and people with disabilities.\n\nThese routes are still reasonable considering the 5-8 hours heads-up the residents received - that they have enough time to get home to find essential emergency items or family members and evacuate.\n\n\n\nAs seen in the map, the python algorithm was successful in assigning neighbourhood centroids to maximise the use of shelters. The neighbourhood centroids closest to the perimeter of the flood extent are assigned to the furthest shelters as expected, allowing them to escape earlier to reduce congestion with the people deeper within in the flood extent.\nAs mentioned, the main downside of having assigned routes is that some routes may experience congestion due to traffic bottlenecks (multiple neighbourhoods of people are passing through the same road). However, this can be mitigated as the locals would have knowledge of the alternative routes in the city in case of congestion.\nAs measured, the combined area of the shelters outside of the flood extent (used in before and during scenarios) is 3 hectares though the total area of the residential buildings is 50 hectares. Though this does not account for the number of storeys each building has, it is a sign that the existing shelters may not be sufficient to hold all evacuees.\nWe divide the current area of shelters (assuming at least 1 storey of free space) 33,251m2 by UNHCR’s standard of 3.5m2 per person, to get an estimate of a capacity of more than 9,500 people, which pales in comparison to the 24,500 displaced residents figure.This could be sufficient if the shelters have almost 3 storeys of usable space (85,750m2), but we currently lack data on building heights. \n\nCross-referencing the UN’s 21st September update, in reality only 6 schools were used as designated sites to hold evacuees. Though we are unsure of UN’s considerations in selecting the holding sites, our maps present a possibility of using mosques and hotels as shelters to accommodate more evacuees and save more lives. In the event that our solution remains insufficient, people could also move out of Derna to nearby cities to escape, as the UNOCHA report had noted. The potential lack of shelter capacity should not stop people from evacuating before the flood.\n\n\n\n\n\n\n\nThe map created shows all possible routes from start points from the edge of the flood extent (black paths) to all safe and undamaged shelters - evacuation centres - outside the flood extent. It also shows the shortest routes (red paths) from each specific start point to their nearest shelters. The route with the shortest distance from a start point to a shelter is 41.60 metres while the route with the longest distance from a start point to a shelter is 5380.93 metres. The great disparity between the shortest route and the longest route shows that some shelters are far more inaccessible than others, such as the one on the extreme bottom right corner of the map. This is evident in the relatively sparse distribution of shelters and the lack of suitable road networks that lead to those that are further away from the start points. \nMost of the shortest paths also lead to the same few shelters. This makes sense since those shelters are closest in proximity to the damaged flood area.\n\n\nUpon further analysis, most of the shortest paths from the start points on the left side of the flood extent lead to three of the nearest shelters (circled in yellow) as shown in Zoom-in Map 1 inserted above. Many shelters further away from the flood extent are not included in the evacuation map’s shortest path to safety. The second map also reveals that some shelters (circled in green), though in close proximity to other surrounding shelters, have no path mapped to them. This could possibly be due to the affected road network which the OD Matrix algorithm could not account for. This means that many shelters will be underutilised if all evacuees choose to go to the nearest shelter. \nMoreover, this evacuation map is generated under the assumption that people will be using walking as the primary means to travel from a start point to a shelter, as it is unlikely that vehicles could be used for transportation during the flood, especially starting from the flood extent. In reality, it is possible that there may be alternative routes, such as desire paths, that are more intuitive and efficient for people to use for evacuation to the first shelter they see. \nAlthough the shortest paths show the general routes that would be most convenient for people to use for evacuation to their nearest shelters, this might lead to overcrowding in those few particular shelters. Therefore, it is recommended that people travel to the next nearest shelter if the ‘Shortest Path’ leads them to a shelter that has already maximised its capacity, using ‘All Routes to Shelters’. \n\n\n\n\nThe map created shows all possible routes from start points from the edge of the flood extent (black paths) to all medical centres - hospitals - outside the flood extent. It also shows the shortest routes (red paths) from each specific start point to their nearest hospital. The route with the shortest distance from a start point to a hospital is 818.28 metres while the route with the longest distance from a start point to a hospital is 4427.44 metres. This shows that some start points are considerably closer in proximity to a hospital than others.\n\nThe map also shows that there are only three hospitals which people can evacuate to for medical care outside the flood extent. As seen from the map inserted below, all routes to the nearest hospital from start points on the left side of the flood extent are also all the shortest paths to the hospital, as there is only one hospital in that vicinity. This suggests potential overcrowding in this hospital, and people who are severely injured during the flood and attempting to evacuate from start points nearer the coastline are likely unable to travel to the hospital on foot unless there are emergency ambulances deployed to help them.\n\n\nThe map above indicates that most of the routes to hospitals from start points on the right side of flood extent go to the hospital nearest to the flood extent. This is due to the skewed distribution of hospital locations as the last hospital is situated far away from the start points. \n\nDue to the scarcity of medical centres, it is possible that these hospitals will be overcrowded and their manpower and supplies exhausted to tend to patients. As such, it is recommended that field hospitals or mobile clinics be deployed to remote areas nearer to the flood extent or to evacuation centres with people who require the most medical care.\n\n\n\nWe learnt from team 8's poster showcase to consider the accessibility to hospitals from the shelters. We consider only vehicle timings as we realise the shortest paths may be too far to walk by foot, especially for someone who is injured. Hence, we assume that the injured are able to call an ambulance from the hospital to fetch them. The time taken to send them to the hospital would be double of the time spent on the route as the ambulance has to go back and forth: leave the hospital to fetch them, then send them to the hospital. \n\nThe most likely sickness that could occur at shelters are likely to be diarrhoea from damaged water supplies, or infections, hence we consider the 11 minutes maximum to be reasonable. There are also likely other people with phones to make timely calls for ambulances, and vehicles of other evacuees that would hasten sending the sick to the hospitals in less than 6 minutes (one-way journey instead of back-and-forth).\n\n\nWe consider the 15 minutes maximum time to dispatch an ambulance and fetch the injured people from the flood extent reasonable, though we note limitations such as the possibility of the injured not having a working phone with them, or having to walk up to 379 metres to the nearest startpoint with their injuries after having escaped the flood.\nAlso, we used a different set of road networks from the shortest path analysis in the during scenario (from startpoints to shelters and hospitals). We used OSM roads as it had information on road types (for speeds) and directions to run out fastest time path analysis, compared to the EMSR roads for shortest distance analysis. As such, there were discrepancies where all 60 start points were accessible by EMSR roads but only 46 for OSM roads network. As such, our fastest path analysis was unable to account for 14 of the startpoints.\n\n\n\n\nFor the logistical and water resupplies, we decided to map the shortest path in order to ensure that any people returning back to their homes will have sufficient resources and supplies. The shelters and hospitals would likely be overcrowded, and people will want to return home as well. In the event of a post-flood, we want to ensure that those residents returning home have sufficient supplies and proper water resources. Hence, we mapped the shortest, most accessible routes for both resupplies using the Shortest Path analysis function. \nWe found that there were some centroid points where there weren’t any networks/paths found to lead to it from the starting point. This is due to the unavailability of roads directly to that specific point, hence for those points we can assume that the resupplies needed for that area can be received from the nearest point to it where the possible routes end instead. Given the numerous centroids, and the many specific paths provided by the analysis, we can still use these networks to resupply even if there is not a specific route directly connected to it.\nFor a lot of the paths, we noticed that a few of the paths would diverge from a similar starting point, before heading towards the centroids.\n\n\nAn example is these 2 corners shown, where there were multiple paths diverging depending on the centroids they are heading towards. For suppliers (in the future to centroids, shelters and hospitals), they could place and store resupplies near these diverging points. The trucks and vehicles would then be able to pick up more supplies from these areas on the way to their destination points. It would decentralise any resupply points and reduce the potential load of the vehicles carrying supplies from these points that are very far away from the city. Hence, potential resupplies can be first dropped off at these points, in larger quantities, before being picked up by other vehicles in the area in order to be sent to the destinations. This would ensure faster resupplies, as vehicles would be able to move faster, more frequently and more efficiently to their destinations. \n\n\n\nWe also assumed that people will attempt to return to their homes in the aftermath of the flood and thereby planned out logistical and water resupply routes to the residential areas that had been affected by the flood. However, we also recognise that many survivors might also choose to remain in the shelters until their homes are restored into their original conditions, and hospitals may require more supplies than usual. Hence, we also mapped the logistical and water resupply to shelters and hospitals. \nThough not presented in our physical poster, we mapped out the supply routes to hospitals and shelters outside the flood extent. These utilise roads that have not been damaged by the  floods, and can be used in the Before Flood and After Flood scenarios. As some routes cross the flood extent, they are not advisable for use in the During Flood scenario.\nWhile the After Flood scenario focused on the likely case of providing aid to people who moved back home after the flood has subsided, these maps look into potential use cases of readying the shelters and hospitals before the flood, and resupplying them in the first few weeks after the flood. Supplies in the Before Flood scenario should be enough to last people for 2-3 days for the duration of the flood, while supplies in the After Flood scenario may come as and when replenishments are required.\n\nThe water and logistics resupply routes during the flood take up to 3 hours, and less than 2 hours in the before and after scenario."
  },
  {
    "objectID": "results.html#discussion",
    "href": "results.html#discussion",
    "title": "Results and Discussion",
    "section": "Discussion",
    "text": "Discussion\nThe residents of Derna were warned of the storm 5-8 hours before the flood, though they received conflicting instructions. Our Before Flood scenario constructs a possible assignment of evacuation routes per neighbourhood. As a back-up for those who did not evacuate in time, they can refer to the During Flood scenario map to find the nearest dry road and shelter. As the supplies in the shelters are used and the supplies in the flooded neighbourhoods perish, our After Flood scenario maps the supply routes to the flooded neighbourhoods where we expect most people to return to. We also mapped resupply routes to the hospitals and shelters relevant to the three stages of the disaster.\nAs the 10th September flood in Derna was the one of worst possible flooding due to the simultaneous double dam collapse and hurricane (as it is the 2nd worst recorded dam failure so far (Wikipedia, 2023) and worse than Libyan major floods seen in 1960-2000 (Ashoor, 2022; Motamedi, 2023)) we suggest the construction of evacuation and medical centres in the city. Our maps above reveal the danger of overcrowding in the existing shelters and hospitals in Derna due to the shortage of such emergency facilities. In order to alleviate any overcrowding, we recommend more shelters to be set up or designated and hospitals to be built in the city, especially in remote areas which are currently furthest away from existing facilities. For evacuation centres, this can be done by finding other buildings to repurpose, in particular those with a larger capacity and suitable infrastructure to house more people. In the meantime, if a similar natural disaster occurs again and there are insufficient shelters and hospitals, temporary emergency services can be set up in inaccessible areas that lack adequate road networks and infrastructure. \n\nIn most of our maps (those we did shortest path analysis on), we assumed that during an emergency, all roads can be used as two-way streets which allow vehicles to travel in both directions, to support the transportation of supplies to and fro origin and destination points. However, there is a chance that this may increase the risk of traffic accidents."
  },
  {
    "objectID": "results.html#future-work-and-recommendations",
    "href": "results.html#future-work-and-recommendations",
    "title": "Results and Discussion",
    "section": "Future Work and Recommendations",
    "text": "Future Work and Recommendations\nFor future work recommendations, we could consider mapping out possible routes from shelter to shelter. As the shelters nearest to the flood extent will likely be congested and overcrowded with a large number of evacuees, we suggest they move to the next nearest shelter for safety. However, our current map model – in the During Flood Scenario – only shows routes from the start points from the edge of the flood to the shelters, and not alternative routes from overcrowded shelters to neighbouring shelters. \nOther future work recommendations include:\n\nCollect data on the capacity of the shelters.\nExpand list of potential shelters:\n\nUse a wider study area. \nUse a more comprehensive dataset of shelters, or collate/clean up all existing accessible datasets.\nPossible candidate shelters could be found from shopping centres and community centres. (Learning point from group 7)\nStudy the use of undamaged buildings after the flood has subsided.\n\nMinimise traffic bottlenecks during evacuation.\nCombine multiple trips into a journey: going from the supply source to the shelters in an efficient order, rather than going back and forth to each shelter.\nRank shelters by capacity and proximity to hospital/supplies to prioritise getting people to the better shelters. (Learning point from group 8)\nConsider the population density within each neighbourhood in the flood extent. (Learning point from group 3 and 8)\nPropose potential sites to build future shelters. (Learning point from group 2)\nPropose points (amongst flood edge points or shelters) to deploy ambulances to or set up field hospitals at."
  },
  {
    "objectID": "dataprep.html",
    "href": "dataprep.html",
    "title": "Data Preparation",
    "section": "",
    "text": "We chose to set our project CRS as EPSG:3197 as it is the CRS with the smallest extent that includes our study area."
  },
  {
    "objectID": "results.html#conclusion",
    "href": "results.html#conclusion",
    "title": "Results and Discussion",
    "section": "Conclusion",
    "text": "Conclusion\nIn conclusion, we appreciated the opportunity to be able to use QGIS for a real-life use case, studying a recent disaster that would serve as a warning for future generations to come. We demonstrated a time-based scenario perspective of working on the problem, catering to differing needs (evacuation and supplies) and behaviour at various stages of the disaster management. Though our evacuation routes are of reasonable durations that can save lives, we acknowledge challenges such as congestion and overcrowding. These can be mitigated by using alternative routes (using local knowledge of roads or OD matrix), expanding the list of the potential shelter sites, and further investigations into building capacities.\nThose who require medical help may require field hospitals or ambulance fetching as it is unlikely for them to make it to the hospitals on their own during the flood. Ways to improve the efficiency of the supply routes include storing resupplies near where roads diverge, and combining multiple trips. Future work could also study ranking shelters by capacity and accessibility to amenities, and proposing sites to build future shelters or medical amenities."
  },
  {
    "objectID": "dataprep.html#health-facilities",
    "href": "dataprep.html#health-facilities",
    "title": "Data Preparation",
    "section": "Health Facilities",
    "text": "Health Facilities\nImported health_facilities_polygon(hospitals)\n\nClip by extent using Derna hexagon layer to obtain hospitals in Derna\nOpen the attribute table\nDouble click to input المستشفى الشاعري الألماني for the feature with null value as its name. \nUntoggle editing mode using the pencil icon to save the changes\n\nSave to geopackage:\nHealth facilities(save as hospitals)"
  },
  {
    "objectID": "dataprep.html#shelters",
    "href": "dataprep.html#shelters",
    "title": "Data Preparation",
    "section": "Shelters",
    "text": "Shelters\n\nImport OSM points of interest, and OSM places of worship. \nFrom Menu Bar, open Vector → Geoprocessing Tools → Clip \nClip each of the two layer using the Derna hexagon layer. Rename them to derna_poi and derna_pofw.\nClick once on derna_poi, then click on ‘Select by expression’.\nType the following expression: “fclass” in ( ‘community_centre’ , ‘school’ , ‘hotel’ , ‘college’ , ‘guesthouse’ )\nExport Selected Features from derna_poi as evacuation, using the project CRS.\nFrom the Menu tab, go to Vector → Geoprocessing tools → Union\nSelect evacuation and derna_pofw as the input and overlay layers. Click ‘Run’, then click ‘Close’ if it ran successfully.\nOpen the attribute table of the temporary union layer.\n\n\nCleaning up the fields\n\nClick on Field Calculator icon\nCheck the ‘Update Existing field’ checkbox.\nType the expression coalesce(“field”,“field_2”)e.g. For OSM_ID, coalesce(“osm_id”,“osm_id_2”)\n\nUse the expression @id for fid\n\nThen click ‘OK.’\nRepeat the above steps for code, fclass, name, and fid.\nUntoggle the pencil icon to save the changes.\nClose the attribute table.\nIn the layers panel, double click on the union layer to open its properties.\nNavigate to fields.\nClick on the pencil icon to toggle editing mode.\nSelect all the fields that end with “_2.”\n\nClick on the delete field icon .\nUntoggle the pencil icon to save changes\nClick ‘Apply’ then ‘OK’ to apply the changes and close the properties window.\nOpen the attribute table\nDouble click to input مسجد موسى بن نُصير (shelter 13) and مسجد ابو بكر الصديق  (shelter 11) for the feature with null value as its name. If uncertain which to input, you may compare the location with Google map to find the correct name. \nUntoggle editing mode using the pencil icon to save the changes\nRight click on the union layer and export it to the geopackage as shelters, with EPSG 3197. Set geometry as Point.\nRemove the temporary layer, original evacuation layer, and original pofw layer."
  },
  {
    "objectID": "dataprep.html#centroids",
    "href": "dataprep.html#centroids",
    "title": "Data Preparation",
    "section": "Centroids",
    "text": "Centroids\nData Used:\n\nBLP transportationL (lines) layer from EMSR\nOSM landuse\nFlood extent (from humdata)\nXYZ tiles osm map\n\nProcessing → Toolbox. Search for ‘Polygonize’ and select the one under Vector geometry (not the one under GDAL Raster conversion).\n\n\nSet the EMSR BLP transportationL layer as the input\n\nFrom the menu bar, go to Vector -&gt; Geoprocessing tools -&gt; Clip.\nSelect the polygonised layer as input and flood_extent as overlay layer\n\nSave as flood extent neighbourhoods, EPSG 3197\nRemove the temporary clipped and polygon layers\nLoad the gis_osm_landuse_a_free_1 layer\nSelect by Expression:\n“fclass” = ‘residential’.\nClose the selection window\nFrom menu bar, go to Vector → Geoprocessing Tools → Clip\n\n\n\n\nInstall real centroid if you have not.\nBrowse for somewhere to save the output shapefile\n\n\nNotice there are additional silvers we need to remove.\n\nIn the main project window, set the clipped layer on top of the OSM XYZ tile background\nRight click the layer from the layer panel and open attribute table\nClick on Field Calculator. \nCreate a new field titled area, with decimal field type, using the expression $area\n\nSort the field from the smallest to largest area\nStarting from the smallest area, select the topmost row.\nClick on the pencil icon to toggle editing mode if it is not already turned on\n\nIn main project panel, right click and click Zoom to selection\n\nToggle layer on and off to ensure that the polygon selected does not cover any building on the xyz tiles osm map\nIf the feature highlighted is a silver (does not cover any buildings), delete it, or adjust the vector according to the OSM background\n\nFor the thin strip shown above, we will remove it and assume the people in the 2 half-flooded buildings will go to the polygon near the river to collect their supplies, so the centroid moves northeast where 6 buildings are\n\n\nWe hence shorten it to produce this\n\n\nFrom the menu bar, go to Vector → Geometry tools → Centroids\n\nSet the input layer as the clipped layer you just edited, and check ‘Create centroid for each part’ as some features contain multiple polygons.\n\n\nOpen the centroid layer’s attribute table\nOpen field calculator\n\nCheck update existing field, select fid from the field dropdown, use @id as the expression, then click OK.\n\n\nUntoggle pencil icon editing mode to save the changes\nClose the attribute table\nSave to geopackage as flood_neighbourhood_centroids\n\nHere’s what it looks like:"
  },
  {
    "objectID": "before.html",
    "href": "before.html",
    "title": "Before Flood Scenario",
    "section": "",
    "text": "1 September 2023 OSM Roads\nDownload:\n\nGo to https://download.geofabrik.de/africa/libya.html#\nClick on raw directory index\nDownload ‘libya-230901-free.shp.zip’\nLoad the roads file into the qgis project\nRename it as 'gis_osm_roads_free_1sep 1' for clarity\n\nClipping:\n\nFrom the menu bar, navigate to Vector → Geoprocessing Tools → Clip\nSave the output to the project geopackage as 'osm_roads_1sep23' with EPSG:3197\n\nFinding road speeds:\n\nDerna considered urban as it is a city so we will use 50km/h from (Global Road Safety Facility)\n\nAssume walking speed 5km/h Preferred walking speed - Wikipedia\nWe assume 15km/h for unclassified and service roads as unclassified roads are smaller and people tend to drive sloer on service roads as they approach their destination.\n\n\n\nRight click and open the attribute table for the roads layer\nOpen field calculator.\nSet the field name as speed, output field type as integer, and input the following expression\nCASE\nWHEN “fclass” = ‘primary’ then 50\nWHEN “fclass” = ‘primary_link’ then 50\nWHEN “fclass” = ‘residential’ then 50\nWHEN “fclass” = ‘secondary’  then 50\nWHEN “fclass” = ‘secondary_link’ then 50\nWHEN “fclass” = ‘service’ then 15\nWHEN “fclass” = ‘tertiary’  then 50\nWHEN “fclass” = ‘tertiary_link’ then 50\nWHEN “fclass” = ‘trunk’ then 50\nWHEN “fclass” =  ‘trunk_link’ then 50\nWHEN “fclass” =  ‘unclassified’ then 15\nELSE 5\nEND\nClick ok\nUntoggle the pencil icon to save the changes.\n\n\n\nOD Matrix for Evacuation Routes\n\nImport the shortest_path file from the During Scenario. \nClick once on the shelters layer from the layers panel\nOpen select by expression and type (get_feature(‘shortest_paths_0a8a2e18_0702_4521_bcfa_34e11bb36e35’,‘destination_id’,@id) IS NULL) or @id=27\n\nThe exact string for the shortest_path layer may depend on yours, you can find it from the search bar in the middle pane.\n\n27 is included by hardcoding as it is the destination node for the null values as it is the last value in the (during) shortesst_path attribute table\nClick 'select features' then 'Close'.\n\n\n\nOpen 'Select by Location' and input according to the photo below, then click 'Run' and 'Close'.\n\nYou obtain the following\n\n\n\nFrom Processing Toolbox, search for 'OD Matrix from Layers as Lines (m:n)'\nInput the following parameters as shown in the picture below:\n\nThen right click on the layer in the layers panel to export it, replacing the spaces in its name with underscores.\n\nFor comparison, we also create an OD matrix with similar parameters that optimises for shortest distance, and name it output_od_matrix_distance.\n\n\n\nShortest Evacuation Path\n\nFrom the menu bar, navigate to Database -&gt; DB Manager\n\n\n\nSelect from the dropdown virtual layers → project layers → Output_OD_matrix\nClick on the SQL window icon (middle).\nType the following query then click 'Execute':\n\nselect origin_id, destination_id, min(total_cost) as shortest_path, geometry\nfrom output_od_matrix\ngroup by origin_id\n\nCheck load as a new layer and input the following settings before clicking 'Load'.\n\n\nSave BEFORE_evac_routes to the geopackage and remove temporary layers.\n\nUsing this approach, the fastest route by car takes around 2 minutes. But the shelters are likely to be overcrowded as only 4 shelters are used for the 112 neighbourhoods in the flood extent.\n\n\n\n\nEvacuation Routes to Prevent Shelter Crowding\nWe notice that only the shelters closer to the flood extent are used, which may be crowded.\nTo prevent shelter crowding and to get residents to evacuate to further and safer shelters, we will spread them out. Assuming an equal number of residents per neighbourhood and equal shelter capacity, we divide the 112 neighbourhood centroids by the 12 shelters (outside of flood extent not used in the During scenario), to obtain a rough ratio of 10 neighbourhoods to one shelter. \n\n\nOpen Jupyter notebook and navigate to the project directory where the CSV file is.\nCreate a new jupyter notebook file.\nType the following code:\n\nimport pandas as pd\nod_matrix = pd.read_csv(‘output_od_matrix.csv’)[[‘fid’,‘origin_id’,‘destination_id’,‘total_cost’]]\ncostSorted =  od_matrix.groupby([‘destination_id’])[‘total_cost’].mean().sort_values(ascending=False)\nshelterAssigned = [-1 for i in range(113)]\nshelterAssigned[43]=0\nassigned = 0\nfor shelter in costSorted.index.values: # 12 iterations\n    toThisShelter = od_matrix[od_matrix[‘destination_id’]==shelter].sort_values(‘total_cost’)\n    count = 10 \n    ttsRow = 0\n    while count &gt; 0 and assigned&lt;112 and ttsRow&lt;112: #10+ iterations\n        start = int(toThisShelter.iloc[ttsRow][‘origin_id’])-1\n        if shelterAssigned[start]==-1:\n            #shelterAssigned[start] = shelter\n            shelterAssigned[start] = int(toThisShelter.iloc[ttsRow][‘fid’])\n            count -= 1\n            assigned += 1\n        ttsRow += 1\n# writing to csv file  \nwith open(‘assignShelters.csv’, ‘w’) as csvfile:\n    writer = csv.writer(csvfile)    \n    writer.writerow([‘fid’])  #header\n    # writing data rows  \n    for i in shelterAssigned:\n        if i != 0: #removing error data\n            writer.writerow([i])\n\nThe aim of the above code is to\n\n\nCalculate the mean distance between a shelter and all the neighbourhood centroids in the flood extent.\nStarting from the shelters with the furthest mean distance, we assign to it the 10 closest neighbourhoods that are not already assigned to any shelter.\nThe code will stop when all neighbourhoods have been assigned. The last shelter to be assigned (closest to the flood extent) will have 2 neighbourhoods assigned only, but it can act as a buffer if any other shelter is overcrowded.\n\n\nLoad the output csv into qgis\nClick once on the output_od_matrix (exclude during shelters) layer\nOpen Select by Expression\narray_contains( aggregate(‘assignShelters_00ea0981_86ba_40ae_9f34_343c23af4255’,‘array_agg’,“fid”),to_string(“fid”))\n\n\n\nClick 'Select Features'\nSave selected features to the geopackage as assignedShelters\n\n\n\nMapping\n\nDouble click on the flood extent layer to open its properties\nNavigate to Symbology if it is not already selected\nSelect 'Simple line'\nSet the colour to blue and the stroke width to 1mm. Set stroke style to dot line.\n\nSimilarly, set the lines for the OD_matrix and the fastest routes as 0.5mm.\nSet the symbol of shelters as the topo camp SVG marker.\n\nClick on 'Labels'. \nSet 'Single Labels'.\nSet value to 'Name'. \nClick on 'Buffer', select 'Draw text buffer'.\nClick on 'Formatting', then insert ' ' in Wrap on character.\nClick 'Apply' and 'OK'.\n\nDouble click on the assignedShelters layer to open the properties, then click on Symbology.\nChange 'Single Symbol' to 'Categorized', set value as 'destination_id'. \nClick on 'Symbol' then set the thickness to 1mm.\n\n\n\nFor each symbol, double click into it. \nClick on 'Simple Line'.\nInput the following offsets and colour (bold in the first row):\n\n\n\n-2(red)\n-1(green)\n0 (orange)\n1 (blue)\n2 (brown)\n3 (purple)\n\n\n\n\n14\n12\n15\n1\n8\n11\n\n\n7\n26\n25\n27\n\n\n\n\n\n13\n\n10\n\n\n\n\n\n\n\n\nThe table was derived by finding routes that overlapped and assigning them different offset and colours.\n\n\n\nClick on 'Apply', then 'OK'.\nClick on Project → New Print Layout.\nName the layout 'Before model' then click 'OK'.\nClick on Add item → Add Map. Drag the map to fill the whole extent of the layout.\n\nSet map rotation to 10 degrees.\nSet scale to 26000 \nAdjust the extents such that all shelters are in view. (Use the same increment/decrements of 100 for X min with X max, and for Y min with Y max to maintain the aspect ratio of the map.) This are the extents I ended up with:\n\n\nClick on Add item → Add label\n\nType 'Assigned Evacuation Routes to Shelters'\nSet the font to Georgia, 27 points, style as Bold.\nPlace the label centrally aligned at the top of the map.\n\nClick on Add item → Add North Arrow, drag a rectangle to insert a north arrow.\nClick on Add item → Add Scale Bar, drag a rectangle to insert a scale bar.\nThe legend was made on Inkscape, but you can screenshot the following photo, remove its background and save as .png, then insert into your map.\n\n\n\n\nClick on Add item → Add Picture\n\nSelect the radio button besides 'Raster image'\nBrowse for the saved png photo.\nMove the legend to the bottom right of the map such that it does not cross the flood extent.\n\n\n\n\n\nAnalysis (Distance)\n\nWe double click the layer assignedShelters to open its properties.\nSelect 'Join'.\nSelect output_od_matrix_distance as the join layer, fid as the join field, then select origin_id, destination_id, total_cost as the Joined fields. The inclusion of origin_id and destination_id is to double check the join is performed correctly. Click on \"OK\" to close the edit vector join window, then click on \"Apply\" and \"OK\" to exit the properties window.\n\n\n\n\nThe Join has been performed successfully.\n(Optional) Return to the Edit Vector Join window to uncheck origin_id and destination_id for a cleaner table.\n\n\n\nAnalysis (Area)\n\nLoad the Open Aerial Map 13 Sep tiff file into the qgis project.\nLoad the shelter points layer\nClick on 'New Shapefile layer'\n\n\n\nCreate a new Polygon layer with the project CRS named as 'shelter area.shp' in a Shapefile subfolder of the project folder.\n\n\n\nClick on the pencil icon to toggle editing mode on, then click 'Add Polygon Feature'.\n\n\n\nTrace the building outline of shelters using the satellite image. Left click on the edges of the building when tracing and right click when done. Follow the fid of the shelter layer (which you may check using the identify features tool) when assigning id. You may also refer th OpenStreetMap or OSM_buildings layer for outlining buildings in cloudy areas.\n\n\n\nWhen done, open the attribute table of the shelter area layer.\nOpen Field calculator. Create a new decimal field called 'area' using the expression $area\n\n\n\nUntoggle edit mode to save the changes.\nOpen 'Select by Expression' and input the expression sum(“area”)\n\n\n\nThis means that the area of the shelters is 3 hectares.\n\n\n\nLoad the OSM_buildings layer and clip by the derna hexagon layer.\nSave the result as derna_buildings.\nOpen 'Select by Location' and input Select features from derna_buildings where the features are within flood_extent_neighbourhoods.\n\n\n\nOpen attribute table for derna_buildings, then field calculator.\nCreate a new decimal field 'area' with the formula $area, only updating the selected features\n\n\n\nClick 'OK', then untoggle editing mode to save changes.\nOpen 'Select by Expression', then input the formula sum(\"area\")\n\n\n\nThis means that the residential area in the flood extent is 50 hectares.\n\nWe are now finished with the preparation of the before scenario maps and analysis."
  },
  {
    "objectID": "during.html",
    "href": "during.html",
    "title": "During Flood Scenario",
    "section": "",
    "text": "Setting the Scene\nFor the During Flood scenario, we decided to use the points which the perimeter of the flood extent (flood extent outline) intersects with the roads as origin points where people can evacuate from the flood. This is because the road network within the flood area would be destroyed and flooded, and therefore unable to be used for evacuation.\nThus in this scenario, we assumed that remaining survivors of the flood would be able to escape to the edge of the flood extent and use the undestroyed road networks outside of the damaged area to evacuate to shelters and hospitals. Using the Roads data from Copernicus ESMR, we were thus able to ascertain which roads outside the flood extent could be used, which was all of them as the destroyed and damaged roads were mostly within the flood extent.\n\n\n\nClipping Roads outside of Flood Extent\nFrom menu bar, select Vector → Geoprocessing Tools → Difference\n\nDifference dialogue window appears. \n\nUnder Input layer, select emsr_roads (the GRA version)\nFor Overlay layer, select flood_extent\nClick on Run.\n\n\nMap window should now look like this with a temporary Difference layer created. Save this layer into Geopackage, naming it emsr_roads_outside_flood.\n\n\n\nConverting Flood Extent Polygon to a Line layer\nFrom the menu bar, select Processing → Toolbox.\n\nType ‘polygon to lines’ in the search bar\nSelect Polygons to lines under Vector geometry\n\n\nPolygons to lines dialogue window appears.\n\n\nUnder Input layer, select flood_extent\nClick on Run when ready for operation to run.\n\nA temporary Line output layer will be created. Save this layer into Geopackage and name the layer as flood_extent_line.\n\n\nCreating StartPoints at flood extent layer with Intersection\nFrom Toolbox, type in ‘line intersections’ in search bar.\n\nSelect Line intersections under Vector overlay.\nLine Intersections dialogue window appears. \n\nUnder Input layer, select flood_extent_line\nUnder Intersect layer, select emsr_roads\n\n\nA temporary output layer named Intersections should be added into the map window. \n\n\n\nCleaning Intersection Points\nBefore saving the layer into Geopackage, we need to first check that the intersection points are valid to be considered as Startpoints where people can evacuate from the flood.\n\n\nZoom into the Intersections layer and use Toggle Editing and Select Features to remove points which are connected to broken roads or roads that only lead to another intersection point.\n\n\n\nAfter selecting the points that are unsuitable to be startpoints, click on the Trash icon in the Toggle Editing bar and delete the selected features.\n\n\n\nAfter deleting all unsuitable points, save the temporary layer into Geopackage, name the layer as ‘startpoints’.\n\n\nOD Matrix for Shelters\nNow we want to origin-destination pairs from startpoints to shelters outside the flood extent. The shelters outside of the flood extent have been clipped and the layer is named suitable_shelters.\n\nFrom Processing → Toolbox → type ‘od matrix’.\n\nSelect OD Matrix from Layers as Lines (m:n) under Distance Matrices in the QNEAT3 plugin.\n\n\nThe OD Matrix from Layers as Lines dialogue window appears. \n\nFor Network Layer, select emsr_roads_outside_flood.\nFor From-Point Layer, select startpoints.\nFor To-Point Layer, select suitable_shleters. \nSelect Shortest Path (distance optimization) for Optimization Criterion\nUnder Advanced Parameters, select Matrix geometry follow routes for Generated Matrix Geometry style\n\n\n\n\nClick on Run once ready\n\nMap window should look like this with the Output OD Matrix generated.\n\nSave the output layer into Geopackage, naming it ‘during_OD_matrix’.\n\n\n\nFinding Shortest Paths to Shelters\nFrom menu bar, select Database → DB Manager\n\nSelect Output_OD_matrix layer from Virtual layer\nAdd Query layer and type in the following query:\n\n\n\nClick on Execute\n\n\n\nClick on Load as new layer\nSelect geometry from Geometry column\nClick on Load\n\nMap window should now look like this with the QueryLayer added, showing the shortest paths from startpoints to shelters.\n\nExported querylayer as shortest_paths. [later renamed as shortest_paths (shelters)].\n\n\n\nCreating Centroids for Hospitals\nFrom menu bar, select Vector → Geometry Tools → Centroids\n\nCentroids dialogue window appears.\n\nUnder Input layer, select Hospitals layer\n\n\n\nClick on Run\n\nMap window should look like this with temporary output layer Centroids created.\n\nFrom the menu bar, click on Select Features.\n\nSelect the hospital centroids outside the flood extent and extract them into a new layer, suitable_hospitals.\n\n\n\n\nOD Matrix and Shortest Paths for Hospitals\nRepeat the steps above to create an OD Matrix from startpoints to suitable_hospitals, with parameters as shown below.\n\nRepeat the steps above, using DB Manager to create a QueryLayer that computes the shortest paths from startpoints to hospitals using the OD Matrix.\n\nAfter loading the query, a new QueryLayer should be created into QGIS. \n\n\nData Cleaning of Startpoints\nUpon examination of the Realising that some of the startpoints do not have routes to hospitals. Checking both OD matrix attribute tables, selected their Origin IDs and by observation found out that the roads they are connected to are broken. Thus, we removed them from the original startpoints layer. \n\nFrom startpoints layer, open Attribute Table → Select by Expression → selected fids that were not suitable startpoints\n\n\n\nClick on Toggle Editing → Delete features\n\n\n\n\nRepeat the data cleaning steps for other necessary layers like the OD matrices and QueryLayers.  \n\nSave the most recent temporary QueryLayer into Geopackage and name the layer as shortest_paths (hospitals). \nMap window should now look like this.\n\n\n\nMapping\nFollow similar steps from the Before Flood scenario to create these maps, one showing the routes and shortest paths to shelters, the other showing the same but to hospitals outside the flood extent. \n\nSteps for Legend (as the legend for During and After were created in QGIS)\n\nSet the title as ‘Legend’.\nCheck ‘only show items inside linked map’\nUnder Font and text formatting, set the legend title font to Georgia, 16 points.\nUnder Font and text formatting, set the labels font to Georgia, 14 points.\n\n\n\n\n\n\nMedical Accessibility from Shelters and Flood Extent\nSetting OSM road Speeds\n\nOpen the attribute table of the OSM roads (23 oct) layer outside of the flood extent (OSM_roads_outside_flood)\nOpen Field Calculator\nCreate a new Integer field called Speed using the following expression:\n\nCASE\nWHEN “fclass” = ‘primary’ then 50\nWHEN “fclass” = ‘primary_link’ then 50\nWHEN “fclass” = ‘residential’ then 50\nWHEN “fclass” = ‘secondary’  then 50\nWHEN “fclass” = ‘secondary_link’ then 50\nWHEN “fclass” = ‘service’ then 15\nWHEN “fclass” = ‘tertiary’  then 50\nWHEN “fclass” = ‘tertiary_link’ then 50\nWHEN “fclass” = ‘trunk’ then 50\nWHEN “fclass” =  ‘trunk_link’ then 50\nWHEN “fclass” =  ‘unclassified’ then 15\nELSE 5\nEND\n\nClick ‘OK’\nUntoggle editing mode using the pencil icon and save the changes.\nClose the attribute table\n\nOD Matrix\n\nFrom processing tools, search for OD Matrix from Layers as Lines (M:N).\nSet the following parameters: OSM_roads_outside_flood as the Network layer, suitable_shelters as the From-Point Layer, Hospitals as To-Point layer, Fastest Path as Optimization Criterion, Matrix Geometry follows routes as Generated Matrix geometry style, oneway as Direction field with the direction values F,T,B in that order. Speed as speed field and default speed as 5km/h.\n\n\n\nRename the output layer accordingly, ensuring there is no spaces. E.g. ODmatrix_time_shelterToHospital_osmOutsideFlood\nOpen Database -&gt; DB Manager, then navigate to the output layer.\nInput the SQL code:\n\nselect origin_id, destination_id, min(total_cost) as shortest_path, geometry\nfrom ODmatrix_time_shelterToHospital_osmOutsideFlood\ngroup by origin_id\n\nCheck ‘Load as new layer’, input a layer name, check ‘Geometry column’ as geometry, then click ‘Load’.\n\n\n\nSave the output into the geopackage.\nRepeat using the flood extent startpoints as the From-Point layer.\n\n\n\n\nFollow similar steps from the previous scenarios to create maps for these 2 layers. For example,\n\n\nWe are now finished with the preparation of the during scenario maps and analysis."
  },
  {
    "objectID": "after.html",
    "href": "after.html",
    "title": "After Flood Scenario",
    "section": "",
    "text": "We will refer to the OpenStreetMap as a gauge of where the locations are outside of the hexagon layer. \nSince the airports and the water plants are quite a distance away from the city, we will use the osm roads to map out the shortest path they will take to a chosen location on the highways leading into the city. Afterwhich, we will use the EMSR GRA transportationL roads to map the shortest path from those locations to the flood neighbourhood centroids, since those roads are more accurate in terms of damage and usability."
  },
  {
    "objectID": "after.html#getting-airport-points",
    "href": "after.html#getting-airport-points",
    "title": "After Flood Scenario",
    "section": "",
    "text": "We will use osm_transport_a(polygon),since the point files don’t have Martuba airport we will be using the polygons instead."
  },
  {
    "objectID": "after.html#getting-satellite-data-to-check-road-usability",
    "href": "after.html#getting-satellite-data-to-check-road-usability",
    "title": "After Flood Scenario",
    "section": "Getting satellite data to check road usability",
    "text": "Getting satellite data to check road usability\nWe will be using satellite data to compare with the EMSR GRAroads, to double check their usability in the flooded neighbourhoods.\nFrom the Open Aerial Map data, we will load in the layer and clip by extent. We will be using the hexagon layer of Derna as our overlay layer.\n\nThis will be the final product after clipping. We will name it 13_09_23.\nWe will classify the EMSR roads and compare their usability with the satellite data.\n\n\nFor the green damaged roads, we can see that the roads have been mostly covered and affected by the floods, presumably with the dirt and sand and other sediment from flooding. Hence, we will exclude them.\n\n\nFor the destroyed roads, we can see that they have been devastated by the flood, with most if not all of them being unusable and broken, due to the flooding and destruction. We will similarly exclude them.\n\nFor the possibly damaged roads, it can be seen that a majority are actually still usable, with a lot of cars and other vehicles such as trucks still being seen and used based on the data. The roads also appear to be quite clear of excessive dirt and sediment, so they are still drivable in this current situation. Hence, we will include and use them."
  },
  {
    "objectID": "after.html#filter-out-usable-roads",
    "href": "after.html#filter-out-usable-roads",
    "title": "After Flood Scenario",
    "section": "Filter out usable roads",
    "text": "Filter out usable roads\nWe will filter out the non destroyed and damaged roads to be used.\nWe select all the NULL values, then in the field calculator we update the existing \"damage_gra\" field to replace the null with normal roads.\n\nSave the changes.\nWe select the non-damaged roads.\n\nWe extract and save these roads to use for the shortest path. The start point will be our previous end point.\n\n\nThe network of the shortest path to resupply the neighbourhoods will be as follows."
  },
  {
    "objectID": "resupply.html",
    "href": "resupply.html",
    "title": "Resupply to Shelters and Hospitals",
    "section": "",
    "text": "We will use suitable_shelters from the during scenario as our shelters layer.\nWe then use Menu Bar → Vector Tools -&gt; Geoprocessing Tools -&gt; Difference to find the roads outside of the flood extent. We set the input layer as gis_osm_roads_free_1 (23 oct) and the overlay layer as flood extent.\nWe export this file to our geopackage as osm_roads_outside_flood.\n\n\n\nFrom processing toolbox find 'Shortest path (point to layer)'\n\n\n\nClick on 'Run as Batch Process'\nFor start point, click on 'Autofill' → 'Add Values by Expression'\n\n\n\nWe will be running this function four times, for start points (desalination plants and airports) to end points (shelters and hospitals).\nkey in this expression, swapping 'desalination plants' layer for hospital when needed\n\naggregate(layer:=‘desalination plants’,aggregate:=‘array_agg’,expression:=$geometry)\n\nChange the vector representing network to 'gis_osm_roads_free_1' (the 23 oct 2023 version) for both rows\nSet vector layer with endpoints to 'shelters' or 'hospitals'.\nFor shortest path, type 'TEMPORARY_OUTPUT' for both rows.\nRemove the blank first row if needed\n\n\n\n\nClick 'Run'.\nWe obtain this for the initial shortest path analysis (from desalination plants/airports to sheltershospitals) using OSM roads only\n\n\n\nExport the output into the geopackage and rename them accordingly e.g. waterToSheltersDURING1\nRepeat for all 4 combinations of start and end points.\nWe repeat the After Scenario steps with the suitable shelters and hospitals outside the flood extent.\n\nWe will select a point on the shorter road above as our midpoint: 158336.235137,3629392.588741 [EPSG:3197]\n\n\n\n\nWe do the shortest path analysis from the midpoint to the desalination plant, shelters, and hospital using the usable_emsr_roads. \nWe then save these outputs into the geopackage. \n\n\n\nWe will be using 169223.320567,3622521.383079 [EPSG:3197] as our midpoint from the airports, the branch point in the picture below\n\n\n\nWe do the shortest path analysis from the midpoint to the airports, shelters, and hospitals. \nWe then save these outputs into the geopackage. \n\n\n\nWhen mapping, we take note to update the legends and rename the road as route for simplification. This is done by temporarily renaming one of the road layers in the project window's layers panel to 'Route'.\n\n\n\nAlso turn off 'Resize to fit content' under legend.\n\n\nWe get maps that look similar to this:\n\nWe are now finished with the preparation of the resupplies to shelters and hospitals maps and analysis."
  },
  {
    "objectID": "datacleaning.html",
    "href": "datacleaning.html",
    "title": "Data Cleaning",
    "section": "",
    "text": "This is the list of layers we save in the final geopackage. Though not in the picture, we also save the flood extent line to the geopackage."
  }
]